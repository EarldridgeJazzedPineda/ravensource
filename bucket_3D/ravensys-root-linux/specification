DEF[PRIME]=		3.2.0
DEF[ABI26_RELEASE]=	2.6.32
DEF[X_CURRENT]=		EXTRACT_VERSION(PLATFORM_Linux_x86-64)
DEF[X_ABI26]=		Linux/x86_64/x86_64/440053/4.4.0/4.4
DEF[ABI26_FILES]=	2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
DEF[ABI32_FILES]=	2
# ----------------------------------------------------------------------------

NAMEBASE=		ravensys-root-linux
VERSION=		${PRIME}
KEYWORDS=		raven
VARIANTS=		standard ABI26
SDESC[standard]=	Linux ${PRIME} builder system root
SDESC[ABI26]=		Linux ${ABI26_RELEASE} builder system root
HOMEPAGE=		none
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main sting ubuntu1 ubuntu2 ubuntu3 ubuntu4 ubuntu5 ubuntu6
			ubuntu7 ubuntu8 ubuntu9 ubuntu10 ubuntu11
SITES[main]=		https://leaf.dragonflybsd.org/~marino/dports-src/
SITES[ubuntu1]=		http://security.ubuntu.com/ubuntu/pool/main/g/glibc/
SITES[ubuntu2]=		UBUNTU/h/hostname
SITES[ubuntu3]=		UBUNTU/d/dash
SITES[ubuntu4]=		UBUNTU/p/pax
SITES[ubuntu5]=		UBUNTU/d/debianutils
SITES[ubuntu6]=		UBUNTU/b/bsdmainutils
SITES[ubuntu7]=		http://security.ubuntu.com/ubuntu/pool/main/s/shadow/
SITES[ubuntu8]=		http://security.ubuntu.com/ubuntu/pool/main/l/linux/
SITES[ubuntu9]=		UBUNTU/a/attr
SITES[ubuntu10]=	UBUNTU/a/acl
SITES[ubuntu11]=	http://security.ubuntu.com/ubuntu/pool/main/s/systemd/
SITES[sting]=		http://www.ravenports.com/cache-distfiles/

DISTFILE[1]=		dummy-tarball.tar.gz:main
DISTFILE[2]=		locales_2.23-0ubuntu10_all.deb:sting
DISTFILE[3]=		libc6_2.23-0ubuntu9_amd64.deb:sting
DISTFILE[4]=		libc6-dev_2.23-0ubuntu9_amd64.deb:sting
DISTFILE[5]=		hostname_3.16ubuntu2_amd64.deb:ubuntu2
DISTFILE[6]=		dash_0.5.8-2.1ubuntu2_amd64.deb:ubuntu3
DISTFILE[7]=		pax_20151013-1_amd64.deb:ubuntu4
DISTFILE[8]=		debianutils_4.7_amd64.deb:ubuntu5
DISTFILE[9]=		libc-bin_2.23-0ubuntu9_amd64.deb:sting
DISTFILE[10]=		bsdmainutils_9.0.6ubuntu3_amd64.deb:ubuntu6
DISTFILE[11]=		passwd_4.2-3.1ubuntu5.3_amd64.deb:ubuntu7
DISTFILE[12]=		linux-libc-dev_4.4.0-78.99_amd64.deb:sting
DISTFILE[13]=		libc6-dev-amd64_2.23-0ubuntu9_i386.deb:sting
DISTFILE[14]=		libc6-dev_2.23-0ubuntu9_i386.deb:sting
DISTFILE[15]=		libattr1-dev_2.4.47-2_amd64.deb:ubuntu9
DISTFILE[16]=		libattr1_2.4.47-2_amd64.deb:ubuntu9
DISTFILE[17]=		libacl1-dev_2.2.52-3_amd64.deb:ubuntu10
DISTFILE[18]=		libacl1_2.2.52-3_amd64.deb:ubuntu10
DISTFILE[19]=		libudev1_229-4ubuntu21.27_amd64.deb:ubuntu11
DISTFILE[20]=		libudev-dev_229-4ubuntu21.27_amd64.deb:ubuntu11

DIST_SUBDIR=		linux-sysroot

SPKGS[standard]=	single
SPKGS[ABI26]=		single

OPTIONS_AVAILABLE=	NOTSTD ABI26
OPTIONS_STANDARD=	none
VOPTS[ABI26]=		NOTSTD=ON ABI26=ON

ONLY_FOR_OPSYS=		linux

INVALID_RPATH=		yes

BUILD_DEPENDS=		nawk:single:standard
			diffutils:primary:ravensys
			libarchive:primary:static
			gnugrep:primary:ravensys
			file:single:ravensys
			findutils:primary:ravensys
			flex:primary:ravensys
			gzip:single:standard
			xz:tools:standard
			unzip:primary:standard
			m4:primary:noprefix
			bmake:single:standard
			sed:primary:ravensys
			byacc:primary:standard
			less:single:standard
			nvi:single:standard
			coreutils:primary:ravensys
			ravensys-binutils:single:standard
			ncurses:terminfo:standard
			ravensw:single:standard
			mandoc:single:standard
			genpatch:single:standard
			lockf:single:standard
			fetch:single:standard
			ravensys-utils:single:standard
			ccache:primary:standard
			bzip2:tools:standard
			shadow:single:standard
			bash:primary:static

SKIP_BUILD=		yes
SINGLE_JOB=		yes
EXTRACT_DIRTY=		${ABI26_FILES}
EXTRACT_DEB_PACKAGE=	${ABI26_FILES}
PLIST_SUB=		BASE={{SYSPATH}}
INFRASTRUCTURE=		yes

MAKE_ENV=		OPSYS="{{OPSYS}}"
			ARCH="{{ARCH}}"
			ARCHSTD="{{ARCH_STANDARD}}"
			OSVERSION="{{OSVERSION}}"
			OSREL="{{OSREL}}"
			OSMAJOR="{{MAJOR}}"
			MKDIR="{{MKDIR}}"
			GCCX=ravensys-gcc
MAKE_ARGS=		BASE={{RSYS}}

[NOTSTD].DESCRIPTION=			Earlier system root of GNU/Linux
[NOTSTD].DF_INDEX_OFF=			${ABI32_FILES}
[NOTSTD].MAKEFILE_OFF=			SYSTEM=${X_CURRENT}

[ABI26].DESCRIPTION=			GNU/Linux ABI ${ABI26_RELEASE} system root
[ABI26].DF_INDEX_ON=			${ABI26_FILES}
[ABI26].MAKEFILE_ON=			SYSTEM=${X_ABI26}

pre-fetch-NOTSTD-OFF:
	${SH} ${MK_SCRIPTS}/ravensys-root-validate_pkgs.sh ${PREFIX} \
		${OPSYS} ${ARCH} ${ARCH_STANDARD} ${OSVERSION} ${OSREL} ${MAJOR}

post-extract:
	${MKDIR} ${WRKSRC}
	${INSTALL_DATA} ${FILESDIR}/linux.mk ${WRKSRC}/system_specifics.mk
	${INSTALL_DATA} ${MK_SCRIPTS}/ravensys-root-Makefile ${WRKSRC}/Makefile

post-extract-NOTSTD-OFF:
	# ${MV} ${WRKDIR}/${NAMEBASE}_2 ${WRKDIR}/dragonfly

post-extract-ABI26-ON:
	${MKDIR} ${WRKDIR}/linux
.for NDX in ${ABI26_FILES}
	if [ "${NDX}" != "14" ]; then \
		cp -a ${WRKDIR}/${NAMEBASE}_${NDX}/* ${WRKDIR}/linux/ ;\
		${RM} -r ${WRKDIR}/${NAMEBASE}_${NDX} ;\
	fi
.endfor
