DEF[PORTVERSION]=	1.6.8
# ----------------------------------------------------------------------------

NAMEBASE=		fluent-bit
VERSION=		${PORTVERSION}
KEYWORDS=		sysutils
VARIANTS=		standard
SDESC[standard]=	Fast and Lightweight Log processor and forwarder
HOMEPAGE=		https://fluentbit.io/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/fluent:fluent-bit:v${PORTVERSION}
DISTFILE[1]=		generated:main

SPKGS[standard]=	complete primary library

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

FPC_EQUIVALENT=		sysutils/fluent-bit

USES=			cmake bison zlib gmake cclibs:primary,library
CMAKE_ARGS=		-DFLB_DEBUG=Off
			-DFLB_TRACE=Off
			-DFLB_CORO_STACK_SIZE=24576
			-DFLB_TLS=On
			-DFLB_EXAMPLES=On
			-DFLB_OUT_PGSQL=Off
RC_SUBR=		fluent-bit:primary

post-install:
	${MV} ${STAGEDIR}${ETCDIR}/fluent-bit.conf \
		${STAGEDIR}${ETCDIR}/fluent-bit.conf.sample
	${MV} ${STAGEDIR}${ETCDIR}/parsers.conf \
		${STAGEDIR}${ETCDIR}/parsers.conf.sample
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/fluent-bit
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/fluent-bit/libfluent-bit.so
