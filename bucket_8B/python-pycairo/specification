# manually maintained
# SPKGS require changing with a change in default python version
DEF[PORTVERSION]=	1.20.0
DEF[PY27_VERSION]=	1.18.2
DEF[PYDEFAULT]=		EXTRACT_VERSION(PYTHON3_DEFAULT)
DEF[PYXX]=		py${PYDEFAULT:S/.//g}
# ------------------------------------------------------------------------

NAMEBASE=		python-pycairo
VERSION=		${PORTVERSION}
KEYWORDS=		python devel
VARIANTS=		py27 py38 py39
SDESC[py27]=		Bindings for cairo graphics library (PY27)
SDESC[py39]=		Bindings for cairo graphics library (PY39)
SDESC[py38]=		Bindings for cairo graphics library (PY38)
HOMEPAGE=		https://pycairo.readthedocs.io
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		PYPI/p/pycairo
DISTFILE[1]=		pycairo-${PORTVERSION}.tar.gz:main
DISTFILE[2]=		pycairo-${PY27_VERSION}.tar.gz:main
DF_INDEX=		1 2

SPKGS[py27]=		single
SPKGS[py39]=		primary
SPKGS[py38]=		primary common

OPTIONS_AVAILABLE=	PY27 PY38 PY39
OPTIONS_STANDARD=	none
VOPTS[py27]=		PY27=ON PY38=OFF PY39=OFF
VOPTS[py38]=		PY27=OFF PY38=ON PY39=OFF
VOPTS[py39]=		PY27=OFF PY38=OFF PY39=ON

FPC_EQUIVALENT=		graphics/py-cairo
# License listed at PyPI
# LGPL-2.1-only OR MPL-1.1

# install_requires extracted from setup.py

[PY27].USES_ON=				python:py27
[PY27].MAKEFILE_ON=			DISTNAME=pycairo-${PY27_VERSION}
[PY38].USES_ON=				python:py38
[PY38].MAKEFILE_ON=			DISTNAME=pycairo-${PORTVERSION}
[PY39].USES_ON=				python:py39
[PY39].MAKEFILE_ON=			DISTNAME=pycairo-${PORTVERSION}

USES=			pkgconfig
GNOME_COMPONENTS=	cairo

post-install:
	${STRIP_CMD} ${STAGEDIR}${PYTHON_SITELIBDIR}/cairo/*.so
	if [ "${VARIANT}" != "${PYXX}" -a "${VARIANT}" != "py27" ]; then \
		${RM} -r ${STAGEDIR}${PREFIX}/include/pycairo ;\
		${RM} ${STAGEDIR}${PREFIX}/lib/pkgconfig/py3cairo.pc ;\
	fi
