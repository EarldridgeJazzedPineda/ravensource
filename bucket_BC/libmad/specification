DEF[PORTVERSION]=	0.16.3
DEF[SOVERSION]=		${PORTVERSION}
# ----------------------------------------------------------------------------

NAMEBASE=		libmad
VERSION=		${PORTVERSION}
KEYWORDS=		audio
VARIANTS=		standard speed
SDESC[standard]=	High-quality MPEG audio decoder (opt for accuracy)
SDESC[speed]=		High-quality MPEG audio decoder (opt for speed)
HOMEPAGE=		http://www.underbit.com/products/mad/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/tenacityteam:libmad:${PORTVERSION}
DISTFILE[1]=		generated:main

SPKGS[standard]=	single
SPKGS[speed]=		single

OPTIONS_AVAILABLE=	SPEED
OPTIONS_STANDARD=	none
VOPTS[speed]=		SPEED=ON

FPC_EQUIVALENT=		audio/libmad

USES=			cmake
CMAKE_ARGS=		-DMADD_ASM=off
			-DMADD16_ASM=off
			-DASO=on
			-DBUILD_SHARED_LIBS=on
SUB_FILES=		mad.pc
SUB_LIST=		VERSION=${PORTVERSION}
SOVERSION=		${SOVERSION}

[SPEED].DESCRIPTION=			Optimize for speed over accuracy
[SPEED].CMAKE_ARGS_ON=			-DOPTIMIZE=SPEED
[SPEED].CMAKE_ARGS_OFF=			-DOPTIMIZE=ACCURACY

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libmad.so.${SOVERSION}
	${INSTALL_DATA} ${WRKDIR}/mad.pc ${STAGEDIR}${PREFIX}/lib/pkgconfig/
