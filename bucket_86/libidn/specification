DEF[PORTVERSION]=	1.35
DEF[SOVERSION]=		12.6.0
# ----------------------------------------------------------------------------

NAMEBASE=		libidn
VERSION=		${PORTVERSION}
KEYWORDS=		dns
VARIANTS=		standard
SDESC[standard]=	Lib implementing Stringprep, Punycode and IDNA2003
HOMEPAGE=		https://www.gnu.org/software/libidn
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://ftp.gnu.org/gnu/libidn/
DISTFILE[1]=		libidn-${PORTVERSION}.tar.gz:main

SPKGS[standard]=	complete primary docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

# This software has somewhat complicated licensing: Commandline tool, tests,
# examples, etc. are GPLv3+. The C, C# and Java libraries are licensed under
# GPLv2+ or LGPLv3+ or both in parallel. In addition to that the Java library
# is also licensed under APACHE20. The documentation is licensed under the
# GFDLv1.3+ and some files are licensed differently again (as noted in those)
# files...

LICENSE=		GPLv2+:primary
			GPLv3+:primary
			LGPL21+:primary
			LGPL3+:primary
			GFDL:docs
# APACHE20:java  -- Java lib not currently packaged
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYINGv2
			GPLv3+:{{WRKSRC}}/COPYINGv3
			LGPL21+:{{WRKSRC}}/COPYING.LESSERv2
			LGPL3+:{{WRKSRC}}/COPYING.LESSERv3
			GFDL:stock
# APACHE20:{{WRKSRC}}/java/LICENSE-2.0.txt
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
			docs:{{WRKDIR}}/TERMS
LICENSE_SCHEME=		multi

FPC_EQUIVALENT=		dns/libidn

USES=			gettext-runtime gmake iconv libtool makeinfo perl:build pkgconfig
MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-nls
INSTALL_TARGET=		install-strip

SOVERSION=		${SOVERSION}

post-patch:
	${REINPLACE_CMD} -e '/^Libs.private:/s/$$/ @LTLIBINTL@/' \
		${WRKSRC}/libidn.pc.in
	${CP} ${WRKSRC}/COPYING ${WRKDIR}/TERMS

post-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/share/doc/libidn
	${CP} ${WRKSRC}/doc/reference/html/* ${STAGEDIR}${PREFIX}/share/doc/libidn/
